
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Altum Capital - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'altum-dark-bg': '#131722',
                        'altum-card-bg': '#1E222D',
                        'altum-border': '#2A2E39',
                        'altum-accent': '#377DFF',
                        'altum-accent-hover': '#529BFF',
                        'altum-text-primary': '#D1D4DC',
                        'altum-text-secondary': '#848E9C',
                        'success': '#10B981',
                        'danger': '#EF4444',
                        'warning': '#F59E0B',
                    }
                }
            }
        }
    </script>
    <style>
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1E222D;
        }
        ::-webkit-scrollbar-thumb {
            background-color: #377DFF;
            border-radius: 4px;
            border: 2px solid #1E222D;
        }
        ::-webkit-scrollbar-thumb:hover {
            background-color: #529BFF;
        }

        .chartjs-tooltip {
            background: rgba(30, 34, 45, 0.9) !important;
            color: #D1D4DC !important;
            border: 1px solid #2A2E39 !important;
        }
        .chartjs-tooltip-key {
            background-color: #377DFF !important;
        }

        .circular-chart .circle-bg {
            stroke: #2A2E39;
        }
        .circular-chart .circle {
            stroke: #377DFF;
            stroke-dasharray: 0, 100;
            animation: circle-fill 1.5s ease-in-out forwards;
        }
        .circular-chart .percentage {
             fill: #377DFF;
             font-size: 8px;
             text-anchor: middle;
             dy: 0.3em;
        }

        @keyframes circle-fill {
            to {
                stroke-dasharray: var(--percentage), 100;
            }
        }

        input:focus, select:focus {
            outline: 2px solid transparent;
            outline-offset: 2px;
            --tw-ring-color: var(--altum-accent);
            box-shadow: 0 0 0 2px var(--altum-dark-bg), 0 0 0 4px var(--tw-ring-color);
        }

        .investor-row {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .investor-row:hover {
            background-color: #2a2e3980;
        }

        .transition-colors {
            transition: color 0.2s ease, background-color 0.2s ease, border-color 0.2s ease;
        }
        .transition-shadow {
            transition: box-shadow 0.2s ease;
        }
        
        /* Optimized chart container */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        /* Mobile menu */
        .mobile-menu {
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }
        .mobile-menu.open {
            transform: translateX(0);
        }

        /* Active filter chips */
        .filter-chip {
            display: inline-flex;
            align-items: center;
            background-color: rgba(55, 125, 255, 0.2);
            color: #377DFF;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .filter-chip button {
            margin-left: 0.25rem;
            color: #377DFF;
        }

        /* Empty state */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            text-align: center;
            color: #848E9C;
        }
        .empty-state i {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #2A2E39;
        }

        /* Table sorting */
        .sortable-header {
            cursor: pointer;
            user-select: none;
        }
        .sortable-header:hover {
            color: #D1D4DC;
        }
        .sortable-header.active {
            color: #377DFF;
        }
        .sortable-header.active .sort-icon {
            opacity: 1;
        }
        .sort-icon {
            opacity: 0;
            transition: opacity 0.2s;
            margin-left: 0.25rem;
        }

        /* Focus styles for accessibility */
        button:focus, a:focus, input:focus, select:focus {
            outline: 2px solid #377DFF;
            outline-offset: 2px;
        }
    </style>
</head>
<body class="bg-altum-dark-bg text-altum-text-primary font-sans">
    <!-- Barra de navegación -->
    <nav class="bg-altum-card-bg text-altum-text-primary shadow-lg border-b border-altum-border">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <i class="fas fa-chart-line text-2xl text-altum-accent"></i>
                <span class="text-xl font-bold text-white">ALTUM CAPITAL</span>
            </div>
            <div class="hidden md:flex items-center space-x-6">
                <a href="#" class="text-altum-text-secondary hover:text-white font-medium transition-colors">Dashboard</a>
                <a href="#" class="text-altum-text-secondary hover:text-white transition-colors">Inversores</a>
                <a href="#" class="text-altum-text-secondary hover:text-white transition-colors">Reportes</a>
                <button class="bg-altum-accent hover:bg-altum-accent-hover text-white px-4 py-2 rounded-md font-semibold transition-colors shadow-md hover:shadow-lg text-sm">Depositar</button>
            </div>
            <div class="md:hidden">
                <button id="mobile-menu-button" class="text-white focus:outline-none">
                    <i class="fas fa-bars text-2xl"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="mobile-menu fixed inset-y-0 left-0 z-50 w-64 bg-altum-card-bg shadow-lg p-4 border-r border-altum-border">
        <div class="flex justify-between items-center mb-8">
            <div class="flex items-center space-x-3">
                <i class="fas fa-chart-line text-2xl text-altum-accent"></i>
                <span class="text-xl font-bold text-white">ALTUM CAPITAL</span>
            </div>
            <button id="close-mobile-menu" class="text-altum-text-secondary hover:text-white">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <nav class="space-y-4">
            <a href="#" class="block px-4 py-2 text-white bg-altum-dark-bg rounded-md">Dashboard</a>
            <a href="#" class="block px-4 py-2 text-altum-text-secondary hover:text-white transition-colors">Inversores</a>
            <a href="#" class="block px-4 py-2 text-altum-text-secondary hover:text-white transition-colors">Reportes</a>
            <button class="w-full mt-6 bg-altum-accent hover:bg-altum-accent-hover text-white px-4 py-2 rounded-md font-semibold transition-colors shadow-md hover:shadow-lg text-sm">Depositar</button>
        </nav>
    </div>

    <!-- Contenido principal -->
    <main class="container mx-auto px-4 py-8">
        <!-- Banner de bienvenida -->
        <div class="bg-altum-card-bg border border-altum-border text-white rounded-lg p-6 mb-8 shadow-md">
            <div class="flex flex-col md:flex-row md:justify-between md:items-center">
                <div>
                    <h1 class="text-2xl md:text-3xl font-semibold mb-2 text-white">¡Bienvenido a Altum Capital!</h1>
                    <p class="mb-4 text-altum-text-secondary">Estamos comprometidos con una gestión responsable, transparente y segura de tus inversiones.</p>
                </div>
                <button class="bg-altum-accent hover:bg-altum-accent-hover text-white px-4 py-2 rounded-md font-medium transition-colors shadow-sm hover:shadow-md text-sm md:w-auto w-full">
                    Conoce más <i class="fas fa-chevron-right ml-1 text-xs"></i>
                </button>
            </div>
        </div>

        <!-- KPIs Resumen -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-altum-card-bg rounded-lg shadow-md p-5 border border-altum-border hover:border-altum-accent/50 transition-colors">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="text-base font-medium text-altum-text-secondary">Total Invertido</h3>
                    <i class="fas fa-coins text-altum-accent text-lg"></i>
                </div>
                <p class="text-3xl font-semibold text-white mb-1" id="total-invested">$36,905.39</p>
                <div class="flex items-center text-sm text-success">
                    <i class="fas fa-arrow-up mr-1"></i>
                    <span>+5.8% este mes</span>
                </div>
            </div>
            <div class="bg-altum-card-bg rounded-lg shadow-md p-5 border border-altum-border hover:border-altum-accent/50 transition-colors">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="text-base font-medium text-altum-text-secondary">Inversores Activos</h3>
                    <i class="fas fa-users text-altum-accent text-lg"></i>
                </div>
                <p class="text-3xl font-semibold text-white mb-1" id="active-investors">8</p>
                <div class="flex items-center text-sm text-success">
                    <i class="fas fa-arrow-up mr-1"></i>
                    <span>+2 este mes</span>
                </div>
            </div>
            <div class="bg-altum-card-bg rounded-lg shadow-md p-5 border border-altum-border hover:border-altum-accent/50 transition-colors">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="text-base font-medium text-altum-text-secondary">Rendimiento Promedio</h3>
                    <i class="fas fa-percentage text-altum-accent text-lg"></i>
                </div>
                <p class="text-3xl font-semibold text-white mb-1" id="avg-performance">7.0%</p>
                <div class="mt-3">
                    <div class="w-full bg-altum-border rounded-full h-2">
                        <div class="bg-altum-accent h-2 rounded-full" style="width: 70%"></div>
                    </div>
                </div>
            </div>
            <div class="bg-altum-card-bg rounded-lg shadow-md p-5 border border-altum-border hover:border-altum-accent/50 transition-colors">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-base font-medium text-altum-text-secondary">Operaciones Hoy</h3>
                    <i class="fas fa-exchange-alt text-altum-accent text-lg"></i>
                </div>
                <p class="text-3xl font-semibold text-white mb-1" id="today-operations">12</p>
                <div class="flex items-center text-sm text-altum-text-secondary">
                    <i class="fas fa-info-circle mr-1"></i>
                    <span>+3% vs ayer</span>
                </div>
            </div>
        </div>

        <!-- Filtros y búsqueda -->
        <div class="bg-altum-card-bg rounded-lg shadow-md p-4 mb-8 border border-altum-border">
            <!-- Active filters chips -->
            <div id="active-filters" class="mb-4 flex flex-wrap hidden">
                <span class="text-sm text-altum-text-secondary mr-2">Filtros:</span>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
                <div>
                    <label class="block text-xs font-medium text-altum-text-secondary mb-1">Buscar inversor</label>
                    <div class="relative">
                        <input type="text" id="search-investor" class="w-full pl-10 pr-4 py-2 bg-altum-dark-bg border border-altum-border rounded-md focus:ring-altum-accent focus:border-altum-accent transition-colors text-sm text-altum-text-primary placeholder-altum-text-secondary" placeholder="Nombre o código">
                        <div class="absolute left-3 top-2.5 text-altum-text-secondary">
                            <i class="fas fa-search text-xs"></i>
                        </div>
                    </div>
                </div>
                <div>
                    <label class="block text-xs font-medium text-altum-text-secondary mb-1">Estado</label>
                    <select id="filter-status" class="w-full px-4 py-2 bg-altum-dark-bg border border-altum-border rounded-md focus:ring-altum-accent focus:border-altum-accent transition-colors text-sm text-altum-text-primary">
                        <option value="">Todos</option>
                        <option value="Bajo">Bajo</option>
                        <option value="Medio">Medio</option>
                        <option value="Alto">Alto</option>
                    </select>
                </div>
                <div>
                    <label class="block text-xs font-medium text-altum-text-secondary mb-1">Balance</label>
                    <select id="filter-balance" class="w-full px-4 py-2 bg-altum-dark-bg border border-altum-border rounded-md focus:ring-altum-accent focus:border-altum-accent transition-colors text-sm text-altum-text-primary">
                        <option value="">Todos</option>
                        <option value="10000">Mayor a $10,000</option>
                        <option value="5000-10000">Entre $5,000-$10,000</option>
                        <option value="5000">Menor a $5,000</option>
                    </select>
                </div>
                <div class="flex items-end space-x-2">
                    <button id="apply-filters" class="w-full bg-altum-accent hover:bg-altum-accent-hover text-white px-4 py-2 rounded-md font-semibold transition-colors shadow-sm hover:shadow-md text-sm">
                        Aplicar Filtros
                    </button>
                    <button id="reset-filters" class="px-3 py-2 bg-altum-card-bg border border-altum-border rounded-md text-altum-text-secondary hover:bg-altum-border transition-colors" title="Resetear filtros">
                        <i class="fas fa-undo text-sm"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Exportar datos -->
        <div class="flex justify-end mb-4">
            <div class="relative">
                <button id="export-button" class="bg-altum-card-bg border border-altum-border text-altum-text-primary px-4 py-2 rounded-md hover:bg-altum-border transition-colors text-sm flex items-center">
                    <i class="fas fa-download mr-2"></i> Exportar
                </button>
                <div id="export-dropdown" class="hidden absolute right-0 mt-1 w-48 bg-altum-card-bg border border-altum-border rounded-md shadow-lg z-10">
                    <div class="py-1">
                        <a href="#" class="block px-4 py-2 text-sm text-altum-text-primary hover:bg-altum-dark-bg export-option" data-type="csv">CSV</a>
                        <a href="#" class="block px-4 py-2 text-sm text-altum-text-primary hover:bg-altum-dark-bg export-option" data-type="pdf">PDF</a>
                        <a href="#" class="block px-4 py-2 text-sm text-altum-text-primary hover:bg-altum-dark-bg export-option" data-type="excel">Excel</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lista de inversores -->
        <div class="bg-altum-card-bg rounded-lg shadow-lg overflow-hidden mb-8 border border-altum-border">
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-altum-border">
                    <thead class="bg-altum-border bg-opacity-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="id"># <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="username">Inversor <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="code">Código <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="balance">Balance USD <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="performance">Rendimiento <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="status">Estado <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider">Acciones</th>
                        </tr>
                    </thead>
                    <tbody class="bg-altum-card-bg divide-y divide-altum-border" id="investors-table">
                        <!-- Inversores se cargarán dinámicamente -->
                    </tbody>
                </table>
            </div>
            
            <!-- Empty state -->
            <div id="empty-state" class="empty-state hidden">
                <i class="fas fa-user-slash"></i>
                <h4 class="text-lg font-medium mb-2">No se encontraron inversores</h4>
                <p class="text-sm max-w-md">No hay inversores que coincidan con los filtros aplicados. Intenta con otros criterios de búsqueda.</p>
                <button id="reset-filters-empty" class="mt-4 bg-altum-accent hover:bg-altum-accent-hover text-white px-4 py-2 rounded-md font-medium transition-colors text-sm">
                    Limpiar filtros
                </button>
            </div>

            <!-- Paginación Tabla -->
            <div class="px-6 py-4 bg-altum-card-bg border-t border-altum-border flex justify-between items-center">
                <div class="text-sm text-altum-text-secondary">
                    Mostrando <span class="font-medium text-altum-text-primary" id="showing-from">1</span> a <span class="font-medium text-altum-text-primary" id="showing-to">8</span> de <span class="font-medium text-altum-text-primary" id="total-investors">8</span> inversores
                </div>
                <div class="flex space-x-2">
                    <button id="prev-page" class="px-3 py-1 bg-altum-dark-bg border border-altum-border rounded-md text-sm text-altum-text-secondary disabled:opacity-50 hover:bg-altum-border transition-colors" disabled>Anterior</button>
                    <button id="next-page" class="px-3 py-1 bg-altum-dark-bg border border-altum-border rounded-md text-sm text-altum-text-secondary disabled:opacity-50 hover:bg-altum-border transition-colors" disabled>Siguiente</button>
                </div>
            </div>
        </div>

        <!-- Detalle del inversor -->
        <div id="investor-detail" class="hidden bg-altum-card-bg rounded-lg shadow-xl overflow-hidden mb-8 border border-altum-border">
            <!-- Encabezado del detalle -->
            <div class="border-b border-altum-border px-6 py-4 flex justify-between items-center bg-altum-border bg-opacity-50">
                <h2 class="text-xl font-semibold text-white" id="detail-investor-name">Detalle del Inversor</h2>
                <div>
                    <button id="export-investor" class="mr-3 bg-altum-card-bg border border-altum-border text-altum-text-primary px-3 py-1 rounded-md hover:bg-altum-border transition-colors text-sm flex items-center">
                        <i class="fas fa-download mr-1"></i> Exportar
                    </button>
                    <button id="close-detail" class="text-altum-text-secondary hover:text-white transition-colors">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- Contenido del detalle -->
            <div class="p-6">
                <!-- Resumen rápido -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                    <!-- Balance -->
                    <div class="bg-altum-dark-bg rounded-lg shadow-md p-5 border border-altum-border hover:border-altum-accent/50 transition-colors">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="text-base font-medium text-altum-text-secondary">Balance Total</h3>
                            <i class="fas fa-wallet text-altum-accent text-lg"></i>
                        </div>
                        <p class="text-3xl font-semibold text-white mb-1" id="detail-balance">$18,601.00</p>
                        <div class="flex items-center text-sm text-success" id="detail-balance-change">
                            <i class="fas fa-arrow-up mr-1"></i>
                            <span>+2.3% este mes</span>
                        </div>
                    </div>

                    <!-- Rendimiento -->
                    <div class="bg-altum-dark-bg rounded-lg shadow-md p-5 border border-altum-border hover:border-altum-accent/50 transition-colors">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="text-base font-medium text-altum-text-secondary">Rendimiento</h3>
                            <i class="fas fa-chart-pie text-altum-accent text-lg"></i>
                        </div>
                        <p class="text-3xl font-semibold text-white" id="detail-performance">7.2%</p>
                        <div class="mt-3">
                            <div class="w-full bg-altum-border rounded-full h-2">
                                <div class="bg-altum-accent h-2 rounded-full" id="detail-performance-bar" style="width: 72%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Estado de cuenta -->
                    <div class="bg-altum-dark-bg rounded-lg shadow-md p-5 border border-altum-border hover:border-altum-accent/50 transition-colors">
                        <div class="flex justify-between items-center mb-4">
                             <h3 class="text-base font-medium text-altum-text-secondary">Estado de Cuenta</h3>
                             <i class="fas fa-check-circle text-altum-accent text-lg"></i>
                        </div>
                        <div class="flex items-center mb-3" id="detail-status">
                             <span class="px-2 py-0.5 bg-blue-900 bg-opacity-50 text-blue-300 rounded-full text-xs font-medium">Activa</span>
                             <span class="ml-2 text-altum-text-secondary text-xs">Riesgo: Bajo</span>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <p class="text-xs text-altum-text-secondary">Depósitos</p>
                                <p class="font-semibold text-white text-sm" id="detail-deposits">12</p>
                            </div>
                            <div>
                                <p class="text-xs text-altum-text-secondary">Retiros</p>
                                <p class="font-semibold text-white text-sm" id="detail-withdrawals">4</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pestañas -->
                <div class="border-b border-altum-border mb-6">
                    <nav class="-mb-px flex space-x-8">
                        <button class="tab-button active border-b-2 border-altum-accent text-altum-accent px-4 py-3 text-sm font-medium" data-tab="operations">
                            Operaciones
                        </button>
                        <button class="tab-button border-b-2 border-transparent text-altum-text-secondary hover:text-altum-text-primary px-4 py-3 text-sm font-medium" data-tab="transactions">
                            Transacciones
                        </button>
                        <button class="tab-button border-b-2 border-transparent text-altum-text-secondary hover:text-altum-text-primary px-4 py-3 text-sm font-medium" data-tab="assets">
                            Distribución
                        </button>
                    </nav>
                </div>

                <!-- Contenido de pestañas -->
                <div id="operations-tab" class="tab-content">
                    <!-- Sección de operaciones -->
                    <div class="bg-altum-dark-bg rounded-lg shadow-md overflow-hidden mb-8 border border-altum-border">
                        <div class="border-b border-altum-border px-6 py-4 flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-white">Historial de Operaciones</h3>
                            <div class="flex items-center space-x-4">
                                <div class="relative">
                                    <input type="text" id="search-operations" class="pl-8 pr-4 py-1 bg-altum-card-bg border border-altum-border rounded-md text-sm text-altum-text-primary placeholder-altum-text-secondary" placeholder="Buscar operación...">
                                    <div class="absolute left-2 top-2 text-altum-text-secondary">
                                        <i class="fas fa-search text-xs"></i>
                                    </div>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="date-filter px-3 py-1 bg-altum-accent text-white rounded-md text-xs font-medium hover:bg-altum-accent-hover transition-colors" data-range="today">Hoy</button>
                                    <button class="date-filter px-3 py-1 bg-altum-card-bg border border-altum-border rounded-md text-xs font-medium text-altum-text-secondary hover:bg-altum-border transition-colors" data-range="week">Semana</button>
                                    <button class="date-filter px-3 py-1 bg-altum-card-bg border border-altum-border rounded-md text-xs font-medium text-altum-text-secondary hover:bg-altum-border transition-colors" data-range="month">Mes</button>
                                </div>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                             <table class="min-w-full divide-y divide-altum-border">
                                <thead class="bg-altum-border bg-opacity-30">
                                    <tr>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="date">Fecha <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="operation">Operación <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="session">Sesión <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="open">Apertura <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="close">Cierre <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="result">Resultado <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider">Observación</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-altum-dark-bg divide-y divide-altum-border" id="detail-operations">
                                    <!-- Operaciones se cargarán aquí -->
                                </tbody>
                            </table>
                        </div>
                        <div id="operations-empty" class="empty-state hidden">
                            <i class="fas fa-exchange-alt"></i>
                            <h4 class="text-lg font-medium mb-2">No hay operaciones registradas</h4>
                            <p class="text-sm max-w-md">Este inversor no tiene operaciones en el periodo seleccionado.</p>
                        </div>
                         <div class="px-6 py-4 bg-altum-dark-bg border-t border-altum-border flex justify-between items-center">
                            <div class="text-sm text-altum-text-secondary">
                                Mostrando <span class="font-medium text-altum-text-primary" id="showing-ops-from">1</span> a <span class="font-medium text-altum-text-primary" id="showing-ops-to">3</span> de <span class="font-medium text-altum-text-primary" id="total-operations">3</span> operaciones
                            </div>
                            <div class="flex space-x-2">
                                <button id="prev-operations" class="px-3 py-1 bg-altum-card-bg border border-altum-border rounded-md text-sm text-altum-text-secondary disabled:opacity-50 hover:bg-altum-border transition-colors" disabled>Anterior</button>
                                <button id="next-operations" class="px-3 py-1 bg-altum-card-bg border border-altum-border rounded-md text-sm text-altum-text-secondary disabled:opacity-50 hover:bg-altum-border transition-colors" disabled>Siguiente</button>
                            </div>
                        </div>
                    </div>

                    <!-- Gráfico de crecimiento mejorado -->
                    <div class="bg-altum-dark-bg rounded-lg shadow-md p-6 mb-8 border border-altum-border hover:border-altum-accent/50 transition-colors">
                        <div class="flex justify-between items-center mb-4">
                            <h4 class="text-base font-medium text-altum-text-secondary">Crecimiento del Balance</h4>
                            <div class="flex space-x-2">
                                <button class="time-range-btn px-3 py-1 bg-altum-card-bg border border-altum-border rounded-md text-xs font-medium text-altum-text-secondary hover:bg-altum-border transition-colors" data-range="1M">1M</button>
                                <button class="time-range-btn px-3 py-1 bg-altum-accent text-white rounded-md text-xs font-medium hover:bg-altum-accent-hover transition-colors" data-range="3M">3M</button>
                                <button class="time-range-btn px-3 py-1 bg-altum-card-bg border border-altum-border rounded-md text-xs font-medium text-altum-text-secondary hover:bg-altum-border transition-colors" data-range="6M">6M</button>
                                <button class="time-range-btn px-3 py-1 bg-altum-card-bg border border-altum-border rounded-md text-xs font-medium text-altum-text-secondary hover:bg-altum-border transition-colors" data-range="1A">1A</button>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="growth-chart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Pestaña de transacciones -->
                <div id="transactions-tab" class="tab-content hidden">
                    <div class="bg-altum-dark-bg rounded-lg shadow-md overflow-hidden mb-8 border border-altum-border">
                        <div class="border-b border-altum-border px-6 py-4 flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-white">Historial de Transacciones</h3>
                            <div class="flex items-center space-x-4">
                                <div class="relative">
                                    <input type="text" id="search-transactions" class="pl-8 pr-4 py-1 bg-altum-card-bg border border-altum-border rounded-md text-sm text-altum-text-primary placeholder-altum-text-secondary" placeholder="Buscar transacción...">
                                    <div class="absolute left-2 top-2 text-altum-text-secondary">
                                        <i class="fas fa-search text-xs"></i>
                                    </div>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="date-filter-tx px-3 py-1 bg-altum-accent text-white rounded-md text-xs font-medium hover:bg-altum-accent-hover transition-colors" data-range="today">Hoy</button>
                                    <button class="date-filter-tx px-3 py-1 bg-altum-card-bg border border-altum-border rounded-md text-xs font-medium text-altum-text-secondary hover:bg-altum-border transition-colors" data-range="week">Semana</button>
                                    <button class="date-filter-tx px-3 py-1 bg-altum-card-bg border border-altum-border rounded-md text-xs font-medium text-altum-text-secondary hover:bg-altum-border transition-colors" data-range="month">Mes</button>
                                </div>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-altum-border">
                                <thead class="bg-altum-border bg-opacity-30">
                                    <tr>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="date">Fecha <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="type">Tipo <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="amount">Monto <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider sortable-header" data-column="method">Método <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-altum-text-secondary uppercase tracking-wider">Estado</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-altum-dark-bg divide-y divide-altum-border" id="detail-transactions">
                                    <!-- Transacciones se cargarán aquí -->
                                </tbody>
                            </table>
                        </div>
                        <div id="transactions-empty" class="empty-state hidden">
                            <i class="fas fa-money-bill-wave"></i>
                            <h4 class="text-lg font-medium mb-2">No hay transacciones registradas</h4>
                            <p class="text-sm max-w-md">Este inversor no tiene transacciones en el periodo seleccionado.</p>
                        </div>
                        <div class="px-6 py-4 bg-altum-dark-bg border-t border-altum-border flex justify-between items-center">
                            <div class="text-sm text-altum-text-secondary">
                                Mostrando <span class="font-medium text-altum-text-primary" id="showing-tx-from">1</span> a <span class="font-medium text-altum-text-primary" id="showing-tx-to">3</span> de <span class="font-medium text-altum-text-primary" id="total-transactions">3</span> transacciones
                            </div>
                            <div class="flex space-x-2">
                                <button id="prev-transactions" class="px-3 py-1 bg-altum-card-bg border border-altum-border rounded-md text-sm text-altum-text-secondary disabled:opacity-50 hover:bg-altum-border transition-colors" disabled>Anterior</button>
                                <button id="next-transactions" class="px-3 py-1 bg-altum-card-bg border border-altum-border rounded-md text-sm text-altum-text-secondary disabled:opacity-50 hover:bg-altum-border transition-colors" disabled>Siguiente</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pestaña de distribución de activos -->
                <div id="assets-tab" class="tab-content hidden">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <!-- Gráfico de distribución -->
                        <div class="bg-altum-dark-bg rounded-lg shadow-md p-6 border border-altum-border hover:border-altum-accent/50 transition-colors">
                            <h4 class="text-base font-medium text-altum-text-secondary mb-4">Distribución de Activos</h4>
                            <div class="chart-container">
                                <canvas id="assets-chart"></canvas>
                            </div>
                        </div>
                        
                        <!-- Lista de activos -->
                        <div class="bg-altum-dark-bg rounded-lg shadow-md p-6 border border-altum-border hover:border-altum-accent/50 transition-colors">
                            <h4 class="text-base font-medium text-altum-text-secondary mb-4">Detalle de Activos</h4>
                            <div class="space-y-4">
                                <div class="flex justify-between items-center">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 rounded-full bg-blue-500 mr-2"></div>
                                        <span class="text-sm text-altum-text-primary">Forex</span>
                                    </div>
                                    <span class="text-sm font-medium text-white" id="forex-percentage">45%</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 rounded-full bg-green-500 mr-2"></div>
                                        <span class="text-sm text-altum-text-primary">Acciones</span>
                                    </div>
                                    <span class="text-sm font-medium text-white" id="stocks-percentage">25%</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 rounded-full bg-yellow-500 mr-2"></div>
                                        <span class="text-sm text-altum-text-primary">Criptomonedas</span>
                                    </div>
                                    <span class="text-sm font-medium text-white" id="crypto-percentage">20%</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 rounded-full bg-purple-500 mr-2"></div>
                                        <span class="text-sm text-altum-text-primary">Materias Primas</span>
                                    </div>
                                    <span class="text-sm font-medium text-white" id="commodities-percentage">10%</span>
                                </div>
                            </div>
                            <div class="mt-6 pt-4 border-t border-altum-border">
                                <div class="flex justify-between text-sm text-altum-text-secondary mb-2">
                                    <span>Exposición total:</span>
                                    <span class="font-medium text-white" id="total-exposure">$18,601.00</span>
                                </div>
                                <div class="flex justify-between text-sm text-altum-text-secondary">
                                    <span>Margen utilizado:</span>
                                    <span class="font-medium text-white" id="used-margin">$1,860.10</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Advertencia de riesgo -->
                <div class="bg-yellow-900 bg-opacity-30 border-l-4 border-warning p-4 rounded-md">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-warning mt-0.5"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-yellow-300">
                                <strong>Advertencia de riesgo:</strong> La inversión en mercados financieros conlleva riesgos y puede resultar en la pérdida de capital. Asegúrese de comprender los riesgos antes de tomar decisiones de inversión.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Pie de página -->
    <footer class="bg-altum-card-bg text-altum-text-secondary border-t border-altum-border py-10">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                 <div>
                    <h3 class="text-lg font-semibold mb-4 text-white">Altum Capital</h3>
                    <p class="text-sm">Comprometidos con una gestión responsable, transparente y segura.</p>
                </div>
                 <div>
                    <h3 class="text-base font-semibold mb-4 text-white">Enlaces Rápidos</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="hover:text-white hover:underline transition-colors">Dashboard</a></li>
                        <li><a href="#" class="hover:text-white hover:underline transition-colors">Inversores</a></li>
                        <li><a href="#" class="hover:text-white hover:underline transition-colors">Reportes</a></li>
                    </ul>
                </div>
                 <div>
                    <h3 class="text-base font-semibold mb-4 text-white">Legal</h3>
                     <ul class="space-y-2 text-sm">
                        <li><a href="#" class="hover:text-white hover:underline transition-colors">Términos y Condiciones</a></li>
                        <li><a href="#" class="hover:text-white hover:underline transition-colors">Política de Privacidad</a></li>
                        <li><a href="#" class="hover:text-white hover:underline transition-colors">Advertencia de Riesgo</a></li>
                    </ul>
                </div>
                 <div>
                    <h3 class="text-base font-semibold mb-4 text-white">Contacto</h3>
                    <ul class="space-y-2 text-sm">
                        <li class="flex items-center"><i class="fas fa-envelope mr-2 text-xs"></i> info@altumcapital.com</li>
                        <li class="flex items-center"><i class="fas fa-phone mr-2 text-xs"></i> +1 (555) 123-4567</li>
                        <li class="flex items-center"><i class="fas fa-map-marker-alt mr-2 text-xs"></i> Ciudad, País</li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-altum-border mt-8 pt-8 text-center text-xs">
                <p>© 2025 Altum Capital. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript optimizado -->
    <script>
        // Datos de todos los inversores
        const investorsData = [
            {
                id: 1,
                username: "rolopez",
                code: "120987654",
                balance: 18601.00,
                deposits: 12,
                withdrawals: 4,
                status: "Bajo",
                cuanto: 93,
                maxLot: 0.5,
                performance: 7.2,
                balanceChange: "+2.3% este mes",
                operations: [
                    { 
                        id: 1,
                        date: "04/14/2025", 
                        operation: "Compra", 
                        session: "New York", 
                        open: 1.13679, 
                        close: 1.14033, 
                        result: "Take Profit", 
                        observation: "Take profit en medio de un rango con bastante indecisión y incertidumbre",
                        symbol: "EUR/USD",
                        lot: 0.5,
                        profit: 354
                    },
                    { 
                        id: 2,
                        date: "04/07/2025", 
                        operation: "Venta", 
                        session: "New York", 
                        open: 1.09673, 
                        close: 1.09465, 
                        result: "Take Profit", 
                        observation: "Operación sumada en las cuentas con el take profit parcial",
                        symbol: "GBP/USD",
                        lot: 0.3,
                        profit: 208
                    },
                    { 
                        id: 3,
                        date: "04/03/2025", 
                        operation: "Compra", 
                        session: "Asia", 
                        open: 1.105584, 
                        close: 1.10644, 
                        result: "Take Profit Parcial", 
                        observation: "Sumarán a las cuentas operaciones del viernes",
                        symbol: "USD/JPY",
                        lot: 0.4,
                        profit: 156
                    }
                ],
                transactions: [
                    {
                        id: 1,
                        date: "04/15/2025",
                        type: "Depósito",
                        amount: 1000,
                        method: "Transferencia Bancaria",
                        status: "Completado"
                    },
                    {
                        id: 2,
                        date: "04/10/2025",
                        type: "Retiro",
                        amount: 500,
                        method: "PayPal",
                        status: "Completado"
                    },
                    {
                        id: 3,
                        date: "04/01/2025",
                        type: "Depósito",
                        amount: 2000,
                        method: "Tarjeta de Crédito",
                        status: "Completado"
                    }
                ],
                assets: {
                    forex: 45,
                    stocks: 25,
                    crypto: 20,
                    commodities: 10
                },
                growthData: {
                    '1M': [15000, 15500, 16200, 16800, 17400, 18000, 18601],
                    '3M': [12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16200, 16800, 17400, 18000, 18601],
                    '6M': [8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16200, 16800, 17400, 18000, 18601],
                    '1A': [5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16200, 16800, 17400, 18000, 18601]
                }
            },
            {
                id: 2,
                username: "esfranco",
                code: "100554350",
                balance: 14220.00,
                deposits: 22,
                withdrawals: 3,
                status: "Bajo",
                cuanto: 47,
                maxLot: 0.3,
                performance: 5.1,
                balanceChange: "+1.8% este mes",
                operations: [
                    { 
                        id: 1,
                        date: "04/14/2025", 
                        operation: "Compra", 
                        session: "New York", 
                        open: 1.13679, 
                        close: 1.14033, 
                        result: "Take Profit", 
                        observation: "Take profit en medio de un rango con bastante indecisión y incertidumbre",
                        symbol: "EUR/USD",
                        lot: 0.3,
                        profit: 212
                    },
                    { 
                        id: 2,
                        date: "04/07/2025", 
                        operation: "Venta", 
                        session: "New York", 
                        open: 1.09673, 
                        close: 1.09465, 
                        result: "Take Profit", 
                        observation: "Operación sumada en las cuentas con el take profit parcial",
                        symbol: "GBP/USD",
                        lot: 0.2,
                        profit: 125
                    },
                    { 
                        id: 3,
                        date: "04/03/2025", 
                        operation: "Compra", 
                        session: "Asia", 
                        open: 1.105584, 
                        close: 1.10644, 
                        result: "Take Profit Parcial", 
                        observation: "Sumarán a las cuentas operaciones del viernes",
                        symbol: "USD/JPY",
                        lot: 0.3,
                        profit: 117
                    }
                ],
                transactions: [
                    {
                        id: 1,
                        date: "04/12/2025",
                        type: "Depósito",
                        amount: 1500,
                        method: "Transferencia Bancaria",
                        status: "Completado"
                    },
                    {
                        id: 2,
                        date: "04/05/2025",
                        type: "Retiro",
                        amount: 750,
                        method: "PayPal",
                        status: "Completado"
                    },
                    {
                        id: 3,
                        date: "03/28/2025",
                        type: "Depósito",
                        amount: 2000,
                        method: "Tarjeta de Crédito",
                        status: "Completado"
                    }
                ],
                assets: {
                    forex: 60,
                    stocks: 20,
                    crypto: 15,
                    commodities: 5
                },
                growthData: {
                    '1M': [8000, 8300, 8600, 8900, 9200, 9400, 9447],
                    '3M': [7000, 7200, 7400, 7600, 7800, 8000, 8200, 8400, 8600, 8800, 9000, 9200, 9447],
                    '6M': [6000, 6200, 6400, 6600, 6800, 7000, 7200, 7400, 7600, 7800, 8000, 8200, 8400, 8600, 8800, 9000, 9200, 9447],
                    '1A': [5000, 5200, 5400, 5600, 5800, 6000, 6200, 6400, 6600, 6800, 7000, 7200, 7400, 7600, 7800, 8000, 8200, 8400, 8600, 8800, 9000, 9200, 9447]
                }
            },
            {
                id: 3,
                username: "mifranco",
                code: "108765432",
                balance: 2724.12,
                deposits: 1,
                withdrawals: 2,
                status: "Alto",
                cuanto: 15.12,
                maxLot: 0.15,
                performance: 15.12,
                balanceChange: "+15.12% este mes",
                operations: [
                    { 
                        id: 1,
                        date: "10/04/2025", 
                        operation: "Compra", 
                        session: "London", 
                        open: 1.10234, 
                        close: 1.10345, 
                        result: "Take Profit", 
                        observation: "Operación en EUR/USD (Stake: 2-5)",
                        symbol: "EUR/USD",
                        lot: 0.15,
                        profit: 111
                    }
                ],
                transactions: [
                    {
                        id: 1,
                        date: "04/10/2025",
                        type: "Depósito",
                        amount: 1000,
                        method: "Transferencia Bancaria",
                        status: "Completado"
                    },
                    {
                        id: 2,
                        date: "03/15/2025",
                        type: "Retiro",
                        amount: 500,
                        method: "PayPal",
                        status: "Completado"
                    }
                ],
                assets: {
                    forex: 30,
                    stocks: 40,
                    crypto: 25,
                    commodities: 5
                },
                growthData: {
                    '1M': [2706.61, 2710.50, 2715.20, 2720.00, 2724.12],
                    '3M': [2500.00, 2600.00, 2650.00, 2706.61, 2724.12],
                    '6M': [2000.00, 2200.00, 2400.00, 2500.00, 2706.61, 2724.12],
                    '1A': [1500.00, 1800.00, 2000.00, 2200.00, 2500.00, 2706.61, 2724.12]
                }
            },
            {
                id: 4,
                username: "dipatermina",
                code: "75042015",
                balance: 800,
                deposits: 1,
                withdrawals: 0,
                status: "Alto",
                cuanto: 7.24,
                maxLot: 0.03,
                performance: 7.24,
                balanceChange: "+7.24% este mes",
                operations: [
                    {
                        id: 1,
                        date: "01/04/2025",
                        operation: "Compra",
                        session: "London",
                        open: 1.0800,
                        close: 1.0825,
                        result: "Take Profit",
                        observation: "EUR/USD - Lote: 0.03",
                        symbol: "EUR/USD",
                        lot: 0.03,
                        profit: 25
                    }
                ],
                transactions: [
                    {
                        id: 1,
                        date: "04/01/2025",
                        type: "Depósito",
                        amount: 1000,
                        method: "Tarjeta de Crédito",
                        status: "Completado"
                    }
                ],
                assets: {
                    forex: 70,
                    stocks: 15,
                    crypto: 10,
                    commodities: 5
                },
                growthData: {
                    '1M': [362, 400, 600, 800],
                    '3M': [300, 362, 400, 600, 800],
                    '6M': [200, 300, 362, 400, 600, 800],
                    '1A': [100, 200, 300, 362, 400, 600, 800]
                }
            },
            {
                id: 5,
                username: "anfionez",
                code: "101867795",
                balance: 351.64,
                deposits: 1,
                withdrawals: 2,
                status: "Alto",
                cuanto: 6.98,
                maxLot: 0.03,
                performance: 6.98,
                balanceChange: "+6.98% este mes",
                operations: [
                    {
                        id: 1,
                        date: "02/04/2025",
                        operation: "Venta",
                        session: "New York",
                        open: 1.0950,
                        close: 1.0925,
                        result: "Take Profit",
                        observation: "EUR/USD - Lote: 0.03",
                        symbol: "EUR/USD",
                        lot: 0.03,
                        profit: 25
                    }
                ],
                transactions: [
                    {
                        id: 1,
                        date: "04/02/2025",
                        type: "Depósito",
                        amount: 500,
                        method: "Transferencia Bancaria",
                        status: "Completado"
                    },
                    {
                        id: 2,
                        date: "03/15/2025",
                        type: "Retiro",
                        amount: 200,
                        method: "PayPal",
                        status: "Completado"
                    }
                ],
                assets: {
                    forex: 80,
                    stocks: 10,
                    crypto: 5,
                    commodities: 5
                },
                growthData: {
                    '1M': [344.76, 350, 351.64],
                    '3M': [300, 320, 344.76, 350, 351.64],
                    '6M': [250, 280, 300, 320, 344.76, 350, 351.64],
                    '1A': [200, 220, 250, 280, 300, 320, 344.76, 350, 351.64]
                }
            },
            {
                id: 6,
                username: "calopez",
                code: "195443700",
                balance: 272,
                deposits: 1,
                withdrawals: 0,
                status: "Alto",
                cuanto: 7.86,
                maxLot: 0.03,
                performance: 7.86,
                balanceChange: "+7.86% este mes",
                operations: [
                    {
                        id: 1,
                        date: "03/04/2025",
                        operation: "Compra",
                        session: "Tokyo",
                        open: 1.0780,
                        close: 1.0800,
                        result: "Take Profit",
                        observation: "EUR/USD - Lote: 0.03",
                        symbol: "EUR/USD",
                        lot: 0.03,
                        profit: 20
                    }
                ],
                transactions: [
                    {
                        id: 1,
                        date: "04/03/2025",
                        type: "Depósito",
                        amount: 300,
                        method: "Tarjeta de Crédito",
                        status: "Completado"
                    }
                ],
                assets: {
                    forex: 90,
                    stocks: 5,
                    crypto: 5,
                    commodities: 0
                },
                growthData: {
                    '1M': [262.14, 265, 270, 272],
                    '3M': [250, 255, 262.14, 265, 270, 272],
                    '6M': [200, 220, 250, 255, 262.14, 265, 270, 272],
                    '1A': [150, 180, 200, 220, 250, 255, 262.14, 265, 270, 272]
                }
            },
            {
                id: 7,
                username: "arlex",
                code: "105689741",
                balance: 237.42,
                deposits: 1,
                withdrawals: 0,
                status: "Alto",
                cuanto: 6.9,
                maxLot: 0.03,
                performance: 6.9,
                balanceChange: "+6.9% este mes",
                operations: [
                    {
                        id: 1,
                        date: "04/04/2025",
                        operation: "Venta",
                        session: "London",
                        open: 1.0850,
                        close: 1.0820,
                        result: "Take Profit",
                        observation: "EUR/USD - Lote: 0.03",
                        symbol: "EUR/USD",
                        lot: 0.03,
                        profit: 30
                    }
                ],
                transactions: [
                    {
                        id: 1,
                        date: "04/04/2025",
                        type: "Depósito",
                        amount: 250,
                        method: "Transferencia Bancaria",
                        status: "Completado"
                    }
                ],
                assets: {
                    forex: 85,
                    stocks: 10,
                    crypto: 5,
                    commodities: 0
                },
                growthData: {
                    '1M': [230.32, 235, 237.42],
                    '3M': [200, 210, 230.32, 235, 237.42],
                    '6M': [180, 190, 200, 210, 230.32, 235, 237.42],
                    '1A': [150, 160, 180, 190, 200, 210, 230.32, 235, 237.42]
                }
            },
            {
                id: 8,
                username: "anprada",
                code: "107363527",
                balance: 500.21,
                deposits: 1,
                withdrawals: 0,
                status: "Medio",
                cuanto: 0.0,
                maxLot: 0.03,
                performance: 0.0,
                balanceChange: "0% este mes",
                operations: [],
                transactions: [
                    {
                        id: 1,
                        date: "17/04/2025",
                        type: "Depósito",
                        amount: 500,
                        method: "Tranferencia Bancaria",
                        status: "Completado"
                    }
                ],
                assets: {
                    forex: 80,
                    commodities: 20
                },
                growthData: {
                    '1M': [500.21],
                    '3M': [500.21],
                    '6M': [500.21],
                    '1A': [500.21]
                }
            }
        ];

        // Variables globales
        let growthChart = null;
        let assetsChart = null;
        let currentTimeRange = '3M';
        let currentInvestorId = null;
        let currentSort = { column: 'id', direction: 'asc' };
        let currentFilters = {
            search: '',
            status: '',
            balance: ''
        };
        let currentPage = 1;
        const investorsPerPage = 5;

        // Función para formatear números como USD
        function formatUSD(amount) {
            return '$' + amount.toLocaleString('en-US', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }

        // Función para formatear fechas
        function formatDate(dateStr) {
            const [month, day, year] = dateStr.split('/');
            return new Date(year, month - 1, day);
        }

        // Función para renderizar la tabla de inversores
        function renderInvestorsTable() {
            const tableBody = document.getElementById('investors-table');
            const emptyState = document.getElementById('empty-state');
            const showingFrom = document.getElementById('showing-from');
            const showingTo = document.getElementById('showing-to');
            const totalInvestors = document.getElementById('total-investors');
            const prevButton = document.getElementById('prev-page');
            const nextButton = document.getElementById('next-page');

            // Filtrar inversores
            let filteredInvestors = investorsData.filter(investor => {
                // Filtro de búsqueda
                const searchMatch = 
                    investor.username.toLowerCase().includes(currentFilters.search.toLowerCase()) || 
                    investor.code.toString().includes(currentFilters.search);
                
                // Filtro de estado
                const statusMatch = 
                    currentFilters.status === '' || 
                    investor.status.toLowerCase() === currentFilters.status.toLowerCase();
                
                // Filtro de balance
                let balanceMatch = true;
                if (currentFilters.balance === '10000') {
                    balanceMatch = investor.balance > 10000;
                } else if (currentFilters.balance === '5000-10000') {
                    balanceMatch = investor.balance >= 5000 && investor.balance <= 10000;
                } else if (currentFilters.balance === '5000') {
                    balanceMatch = investor.balance < 5000;
                }
                
                return searchMatch && statusMatch && balanceMatch;
            });

            // Ordenar inversores
            filteredInvestors.sort((a, b) => {
                let comparison = 0;
                
                switch(currentSort.column) {
                    case 'id':
                        comparison = a.id - b.id;
                        break;
                    case 'username':
                        comparison = a.username.localeCompare(b.username);
                        break;
                    case 'code':
                        comparison = a.code - b.code;
                        break;
                    case 'balance':
                        comparison = a.balance - b.balance;
                        break;
                    case 'performance':
                        comparison = a.performance - b.performance;
                        break;
                    case 'status':
                        comparison = a.status.localeCompare(b.status);
                        break;
                }
                
                return currentSort.direction === 'asc' ? comparison : -comparison;
            });

            // Paginación
            const totalPages = Math.ceil(filteredInvestors.length / investorsPerPage);
            const startIndex = (currentPage - 1) * investorsPerPage;
            const endIndex = Math.min(startIndex + investorsPerPage, filteredInvestors.length);
            const paginatedInvestors = filteredInvestors.slice(startIndex, endIndex);

            // Actualizar controles de paginación
            showingFrom.textContent = filteredInvestors.length > 0 ? startIndex + 1 : 0;
            showingTo.textContent = endIndex;
            totalInvestors.textContent = filteredInvestors.length;
            
            prevButton.disabled = currentPage === 1;
            nextButton.disabled = currentPage === totalPages;

            // Renderizar filas
            tableBody.innerHTML = '';

            if (paginatedInvestors.length === 0) {
                emptyState.classList.remove('hidden');
                tableBody.classList.add('hidden');
            } else {
                emptyState.classList.add('hidden');
                tableBody.classList.remove('hidden');
                
                paginatedInvestors.forEach(investor => {
                    const row = document.createElement('tr');
                    row.className = 'investor-row';
                    row.setAttribute('data-investor-id', investor.id);
                    
                    const statusColor = investor.status === "Bajo" ? "green" : investor.status === "Medio" ? "blue" : "yellow";
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-altum-text-primary">${investor.id}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-white font-medium">${investor.username}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-altum-text-secondary">${investor.code}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-white font-semibold">${formatUSD(investor.balance)}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm ${investor.performance >= 0 ? 'text-success' : 'text-danger'} font-medium">
                            <i class="fas ${investor.performance >= 0 ? 'fa-arrow-up' : 'fa-arrow-down'} mr-1"></i> ${investor.performance}%
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">
                            <span class="px-2 py-1 bg-${statusColor}-900 bg-opacity-50 text-${statusColor}-300 rounded-full text-xs font-medium">${investor.status}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-altum-text-secondary">
                            <button class="text-altum-accent hover:text-altum-accent-hover view-detail transition-colors font-medium" data-id="${investor.id}">
                                <i class="fas fa-eye mr-1 text-xs"></i> Ver
                            </button>
                        </td>
                    `;
                    
                    tableBody.appendChild(row);
                });
            }

            // Actualizar filtros activos
            updateActiveFilters();
        }

        // Función para actualizar los chips de filtros activos
        function updateActiveFilters() {
            const activeFiltersContainer = document.getElementById('active-filters');
            activeFiltersContainer.innerHTML = '';
            
            let hasFilters = false;
            
            if (currentFilters.search) {
                hasFilters = true;
                const chip = document.createElement('span');
                chip.className = 'filter-chip';
                chip.innerHTML = `Búsqueda: "${currentFilters.search}" <button class="remove-filter" data-type="search"><i class="fas fa-times"></i></button>`;
                activeFiltersContainer.appendChild(chip);
            }
            
            if (currentFilters.status) {
                hasFilters = true;
                const chip = document.createElement('span');
                chip.className = 'filter-chip';
                chip.innerHTML = `Estado: ${currentFilters.status} <button class="remove-filter" data-type="status"><i class="fas fa-times"></i></button>`;
                activeFiltersContainer.appendChild(chip);
            }
            
            if (currentFilters.balance) {
                hasFilters = true;
                let balanceText = '';
                if (currentFilters.balance === '10000') {
                    balanceText = 'Balance > $10,000';
                } else if (currentFilters.balance === '5000-10000') {
                    balanceText = 'Balance $5,000-$10,000';
                } else if (currentFilters.balance === '5000') {
                    balanceText = 'Balance < $5,000';
                }
                
                const chip = document.createElement('span');
                chip.className = 'filter-chip';
                chip.innerHTML = `${balanceText} <button class="remove-filter" data-type="balance"><i class="fas fa-times"></i></button>`;
                activeFiltersContainer.appendChild(chip);
            }
            
            if (hasFilters) {
                activeFiltersContainer.classList.remove('hidden');
            } else {
                activeFiltersContainer.classList.add('hidden');
            }
        }

        // Función para crear/actualizar el gráfico de crecimiento
        function updateGrowthChart(chartData, labels) {
            const ctx = document.getElementById('growth-chart').getContext('2d');
            
            // Destruir el gráfico anterior si existe
            if (growthChart) {
                growthChart.destroy();
            }
            
            // Configuración del gráfico optimizada
            const gridColor = 'rgba(42, 46, 57, 0.7)';
            const labelColor = '#848E9C';
            
            growthChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Balance USD',
                        data: chartData,
                        borderColor: '#377DFF',
                        backgroundColor: 'rgba(55, 125, 255, 0.1)',
                        tension: 0.4,
                        fill: true,
                        pointBackgroundColor: '#377DFF',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#377DFF',
                        pointRadius: 3,
                        pointHoverRadius: 5,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(30, 34, 45, 0.9)',
                            titleColor: '#D1D4DC',
                            bodyColor: '#D1D4DC',
                            borderColor: gridColor,
                            borderWidth: 1,
                            padding: 10,
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    return 'Balance: ' + formatUSD(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            grid: { color: gridColor, drawBorder: false },
                            ticks: {
                                color: labelColor,
                                padding: 10,
                                callback: function(value) {
                                    if (value >= 10000) return '$' + (value/1000) + 'k';
                                    return formatUSD(value);
                                }
                            }
                        },
                        x: {
                            grid: { display: false, drawBorder: false },
                            ticks: { color: labelColor, padding: 10 }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
        }

        // Función para crear/actualizar el gráfico de distribución de activos
        function updateAssetsChart(assetsData) {
            const ctx = document.getElementById('assets-chart').getContext('2d');
            
            // Destruir el gráfico anterior si existe
            if (assetsChart) {
                assetsChart.destroy();
            }
            
            // Configuración del gráfico optimizada
            const gridColor = 'rgba(42, 46, 57, 0.7)';
            const labelColor = '#D1D4DC';
            
            assetsChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Forex', 'Acciones', 'Criptomonedas', 'Materias Primas'],
                    datasets: [{
                        data: [assetsData.forex, assetsData.stocks, assetsData.crypto, assetsData.commodities],
                        backgroundColor: [
                            'rgba(55, 125, 255, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(245, 158, 11, 0.8)',
                            'rgba(139, 92, 246, 0.8)'
                        ],
                        borderColor: [
                            'rgba(55, 125, 255, 1)',
                            'rgba(16, 185, 129, 1)',
                            'rgba(245, 158, 11, 1)',
                            'rgba(139, 92, 246, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                color: labelColor,
                                padding: 20,
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(30, 34, 45, 0.9)',
                            titleColor: '#D1D4DC',
                            bodyColor: '#D1D4DC',
                            borderColor: gridColor,
                            borderWidth: 1,
                            padding: 10,
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.raw}%`;
                                }
                            }
                        },
                        datalabels: {
                            color: '#131722',
                            formatter: (value) => {
                                return `${value}%`;
                            },
                            font: {
                                weight: 'bold'
                            }
                        }
                    },
                    cutout: '70%'
                },
                plugins: [ChartDataLabels]
            });
        }

        // Función para mostrar el detalle de un inversor
        function showInvestorDetail(investorId) {
            const investor = investorsData.find(i => i.id === investorId);
            if (!investor) return;

            currentInvestorId = investorId;

            // Actualizar información básica
            document.getElementById('detail-investor-name').textContent = `Detalle: ${investor.username}`;
            document.getElementById('detail-balance').textContent = formatUSD(investor.balance);
            
            const isPositiveChange = investor.balanceChange.startsWith('+');
            const balanceChangeEl = document.getElementById('detail-balance-change');
            balanceChangeEl.innerHTML = `
                <i class="fas ${isPositiveChange ? 'fa-arrow-up' : 'fa-arrow-down'} mr-1"></i>
                <span>${investor.balanceChange}</span>
            `;
            balanceChangeEl.className = `flex items-center text-sm ${isPositiveChange ? 'text-success' : 'text-danger'}`;

            document.getElementById('detail-performance').textContent = `${investor.performance}%`;
            document.getElementById('detail-performance-bar').style.width = `${investor.performance}%`;
            
            const statusContainer = document.getElementById('detail-status');
            const statusText = investor.status === "Bajo" ? "Activo" : investor.status;
            const statusColor = investor.status === "Bajo" ? "blue" : "yellow";
            statusContainer.innerHTML = `
                 <span class="px-2 py-0.5 bg-${statusColor}-900 bg-opacity-50 text-${statusColor}-300 rounded-full text-xs font-medium">${statusText}</span>
                 <span class="ml-2 text-altum-text-secondary text-xs">Riesgo: ${investor.status}</span>
            `;
            
            document.getElementById('detail-deposits').textContent = investor.deposits;
            document.getElementById('detail-withdrawals').textContent = investor.withdrawals;

            // Renderizar operaciones
            renderOperationsTable(investor.operations);

            // Renderizar transacciones
            renderTransactionsTable(investor.transactions);

            // Actualizar distribución de activos
            updateAssetsDistribution(investor);

            // Actualizar el gráfico de crecimiento con el rango de tiempo actual
            updateChartForTimeRange(currentTimeRange, investor);

            // Mostrar el panel de detalle
            document.getElementById('investor-detail').classList.remove('hidden');
            document.getElementById('investor-detail').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Función para renderizar la tabla de operaciones
        function renderOperationsTable(operations, searchTerm = '', dateRange = 'all') {
            const operationsTable = document.getElementById('detail-operations');
            const emptyState = document.getElementById('operations-empty');
            const showingOpsFrom = document.getElementById('showing-ops-from');
            const showingOpsTo = document.getElementById('showing-ops-to');
            const totalOperations = document.getElementById('total-operations');
            const prevButton = document.getElementById('prev-operations');
            const nextButton = document.getElementById('next-operations');

            // Filtrar operaciones
            let filteredOperations = operations.filter(op => {
                // Filtro de búsqueda
                const searchMatch = 
                    searchTerm === '' ||
                    op.symbol.toLowerCase().includes(searchTerm.toLowerCase()) || 
                    op.observation.toLowerCase().includes(searchTerm.toLowerCase());
                
                // Filtro de fecha
                let dateMatch = true;
                if (dateRange !== 'all') {
                    const opDate = formatDate(op.date);
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);
                    
                    if (dateRange === 'today') {
                        dateMatch = opDate.getTime() === today.getTime();
                    } else if (dateRange === 'week') {
                        const weekAgo = new Date(today);
                        weekAgo.setDate(weekAgo.getDate() - 7);
                        dateMatch = opDate >= weekAgo && opDate <= today;
                    } else if (dateRange === 'month') {
                        const monthAgo = new Date(today);
                        monthAgo.setMonth(monthAgo.getMonth() - 1);
                        dateMatch = opDate >= monthAgo && opDate <= today;
                    }
                }
                
                return searchMatch && dateMatch;
            });

            // Actualizar controles
            showingOpsFrom.textContent = filteredOperations.length > 0 ? 1 : 0;
            showingOpsTo.textContent = filteredOperations.length;
            totalOperations.textContent = filteredOperations.length;
            
            prevButton.disabled = true;
            nextButton.disabled = true;

            // Renderizar filas
            operationsTable.innerHTML = '';

            if (filteredOperations.length === 0) {
                emptyState.classList.remove('hidden');
                operationsTable.classList.add('hidden');
            } else {
                emptyState.classList.add('hidden');
                operationsTable.classList.remove('hidden');
                
                filteredOperations.forEach(op => {
                    const row = document.createElement('tr');
                    const resultClass = op.result.includes('Profit') ? 'text-success' : 'text-danger';
                    const operationClass = op.operation === 'Compra'
                        ? 'bg-green-900 bg-opacity-40 text-green-300'
                        : 'bg-red-900 bg-opacity-40 text-red-300';

                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-altum-text-primary">${op.date}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">
                            <span class="px-2 py-1 ${operationClass} rounded-full text-xs font-medium">${op.operation}</span>
                            <span class="ml-2 text-xs text-altum-text-secondary">${op.symbol} (${op.lot} lot)</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-altum-text-secondary">${op.session}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-altum-text-secondary">${op.open}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-altum-text-secondary">${op.close}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium ${resultClass}">
                            ${op.result} (${formatUSD(op.profit)})
                        </td>
                        <td class="px-6 py-4 text-sm text-altum-text-secondary max-w-xs truncate" title="${op.observation}">${op.observation}</td>
                    `;
                    operationsTable.appendChild(row);
                });
            }
        }

        // Función para renderizar la tabla de transacciones
        function renderTransactionsTable(transactions, searchTerm = '', dateRange = 'all') {
            const transactionsTable = document.getElementById('detail-transactions');
            const emptyState = document.getElementById('transactions-empty');
            const showingTxFrom = document.getElementById('showing-tx-from');
            const showingTxTo = document.getElementById('showing-tx-to');
            const totalTransactions = document.getElementById('total-transactions');
            const prevButton = document.getElementById('prev-transactions');
            const nextButton = document.getElementById('next-transactions');

            // Filtrar transacciones
            let filteredTransactions = transactions.filter(tx => {
                // Filtro de búsqueda
                const searchMatch = 
                    searchTerm === '' ||
                    tx.type.toLowerCase().includes(searchTerm.toLowerCase()) || 
                    tx.method.toLowerCase().includes(searchTerm.toLowerCase());
                
                // Filtro de fecha
                let dateMatch = true;
                if (dateRange !== 'all') {
                    const txDate = formatDate(tx.date);
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);
                    
                    if (dateRange === 'today') {
                        dateMatch = txDate.getTime() === today.getTime();
                    } else if (dateRange === 'week') {
                        const weekAgo = new Date(today);
                        weekAgo.setDate(weekAgo.getDate() - 7);
                        dateMatch = txDate >= weekAgo && txDate <= today;
                    } else if (dateRange === 'month') {
                        const monthAgo = new Date(today);
                        monthAgo.setMonth(monthAgo.getMonth() - 1);
                        dateMatch = txDate >= monthAgo && txDate <= today;
                    }
                }
                
                return searchMatch && dateMatch;
            });

            // Actualizar controles
            showingTxFrom.textContent = filteredTransactions.length > 0 ? 1 : 0;
            showingTxTo.textContent = filteredTransactions.length;
            totalTransactions.textContent = filteredTransactions.length;
            
            prevButton.disabled = true;
            nextButton.disabled = true;

            // Renderizar filas
            transactionsTable.innerHTML = '';

            if (filteredTransactions.length === 0) {
                emptyState.classList.remove('hidden');
                transactionsTable.classList.add('hidden');
            } else {
                emptyState.classList.add('hidden');
                transactionsTable.classList.remove('hidden');
                
                filteredTransactions.forEach(tx => {
                    const row = document.createElement('tr');
                    const isDeposit = tx.type === 'Depósito';
                    const amountClass = isDeposit ? 'text-success' : 'text-danger';
                    const statusClass = tx.status === 'Completado' ? 'text-green-300' : 'text-yellow-300';
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-altum-text-primary">${tx.date}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm ${amountClass} font-medium">
                            ${tx.type}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-white">
                            ${formatUSD(tx.amount)}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-altum-text-secondary">${tx.method}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">
                            <span class="px-2 py-1 rounded-full text-xs font-medium ${statusClass}">${tx.status}</span>
                        </td>
                    `;
                    transactionsTable.appendChild(row);
                });
            }
        }

        // Función para actualizar la distribución de activos
        function updateAssetsDistribution(investor) {
            document.getElementById('forex-percentage').textContent = `${investor.assets.forex}%`;
            document.getElementById('stocks-percentage').textContent = `${investor.assets.stocks}%`;
            document.getElementById('crypto-percentage').textContent = `${investor.assets.crypto}%`;
            document.getElementById('commodities-percentage').textContent = `${investor.assets.commodities}%`;
            
            const totalExposure = investor.balance;
            document.getElementById('total-exposure').textContent = formatUSD(totalExposure);
            document.getElementById('used-margin').textContent = formatUSD(totalExposure * 0.1); // 10% de margen
            
            updateAssetsChart(investor.assets);
        }

        // Función para actualizar el gráfico según el rango de tiempo seleccionado
        function updateChartForTimeRange(timeRange, investor) {
            currentTimeRange = timeRange;
            const data = investor.growthData[timeRange];
            
            // Generar etiquetas basadas en el rango de tiempo
            let labels = [];
            const dataLength = data.length;
            
            if (timeRange === '1M') {
                labels = ['Sem 1', 'Sem 2', 'Sem 3', 'Sem 4', 'Actual'];
            } else if (timeRange === '3M') {
                const step = Math.ceil(dataLength / 5);
                for (let i = 0; i < dataLength; i += step) {
                    labels.push(`Mes ${Math.floor(i/step) + 1}`);
                }
                if (labels.length < 5) labels.push('Actual');
            } else if (timeRange === '6M') {
                const step = Math.ceil(dataLength / 6);
                for (let i = 0; i < dataLength; i += step) {
                    labels.push(`Mes ${Math.floor(i/step) + 1}`);
                }
                if (labels.length < 6) labels.push('Actual');
            } else { // 1A
                const step = Math.ceil(dataLength / 12);
                for (let i = 0; i < dataLength; i += step) {
                    labels.push(`Mes ${Math.floor(i/step) + 1}`);
                }
                if (labels.length < 12) labels.push('Actual');
            }
            
            updateGrowthChart(data, labels);
        }

        // Función para exportar datos
        function exportData(type, investorId = null, dataType = 'all') {
            let data, filename;
            
            if (investorId) {
                // Exportar datos de un inversor específico
                const investor = investorsData.find(i => i.id === investorId);
                if (!investor) return;
                
                if (dataType === 'operations') {
                    data = investor.operations;
                    filename = `operaciones_${investor.username}.${type}`;
                } else if (dataType === 'transactions') {
                    data = investor.transactions;
                    filename = `transacciones_${investor.username}.${type}`;
                } else {
                    data = investor;
                    filename = `detalle_${investor.username}.${type}`;
                }
            } else {
                // Exportar todos los inversores
                data = investorsData;
                filename = `inversores_altum_capital.${type}`;
            }
            
            // Simular descarga (en producción, usar API real)
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Renderizar tabla inicial
            renderInvestorsTable();

            // Manejar clics en filas y botones de inversores (solución corregida)
            document.getElementById('investors-table').addEventListener('click', (e) => {
                const row = e.target.closest('.investor-row');
                const button = e.target.closest('.view-detail');
                
                if (button) {
                    e.stopPropagation();
                    const investorId = parseInt(button.getAttribute('data-id'));
                    showInvestorDetail(investorId);
                } else if (row) {
                    const investorId = parseInt(row.getAttribute('data-investor-id'));
                    showInvestorDetail(investorId);
                }
            });

            // Manejar clic en cerrar detalle
            document.getElementById('close-detail').addEventListener('click', () => {
                document.getElementById('investor-detail').classList.add('hidden');
            });

            // Manejar búsqueda en tiempo real
            document.getElementById('search-investor').addEventListener('input', (e) => {
                currentFilters.search = e.target.value;
                currentPage = 1;
                renderInvestorsTable();
            });

            // Manejar filtros
            document.getElementById('filter-status').addEventListener('change', (e) => {
                currentFilters.status = e.target.value;
                currentPage = 1;
                renderInvestorsTable();
            });

            document.getElementById('filter-balance').addEventListener('change', (e) => {
                currentFilters.balance = e.target.value;
                currentPage = 1;
                renderInvestorsTable();
            });

            // Botón aplicar filtros (para consistencia, aunque ya funciona en tiempo real)
            document.getElementById('apply-filters').addEventListener('click', () => {
                currentPage = 1;
                renderInvestorsTable();
            });

            // Botón resetear filtros
            document.getElementById('reset-filters').addEventListener('click', () => {
                currentFilters = {
                    search: '',
                    status: '',
                    balance: ''
                };
                
                document.getElementById('search-investor').value = '';
                document.getElementById('filter-status').value = '';
                document.getElementById('filter-balance').value = '';
                
                currentPage = 1;
                renderInvestorsTable();
            });

            // Botón resetear filtros desde empty state
            document.getElementById('reset-filters-empty').addEventListener('click', () => {
                currentFilters = {
                    search: '',
                    status: '',
                    balance: ''
                };
                
                document.getElementById('search-investor').value = '';
                document.getElementById('filter-status').value = '';
                document.getElementById('filter-balance').value = '';
                
                currentPage = 1;
                renderInvestorsTable();
            });

            // Eliminar filtros individuales
            document.getElementById('active-filters').addEventListener('click', (e) => {
                const removeButton = e.target.closest('.remove-filter');
                if (removeButton) {
                    const filterType = removeButton.getAttribute('data-type');
                    
                    if (filterType === 'search') {
                        currentFilters.search = '';
                        document.getElementById('search-investor').value = '';
                    } else if (filterType === 'status') {
                        currentFilters.status = '';
                        document.getElementById('filter-status').value = '';
                    } else if (filterType === 'balance') {
                        currentFilters.balance = '';
                        document.getElementById('filter-balance').value = '';
                    }
                    
                    currentPage = 1;
                    renderInvestorsTable();
                }
            });

            // Paginación
            document.getElementById('prev-page').addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    renderInvestorsTable();
                }
            });

            document.getElementById('next-page').addEventListener('click', () => {
                const totalPages = Math.ceil(investorsData.length / investorsPerPage);
                if (currentPage < totalPages) {
                    currentPage++;
                    renderInvestorsTable();
                }
            });

            // Ordenación de columnas
            document.querySelectorAll('.sortable-header').forEach(header => {
                header.addEventListener('click', () => {
                    const column = header.getAttribute('data-column');
                    
                    // Resetear todos los headers
                    document.querySelectorAll('.sortable-header').forEach(h => {
                        h.classList.remove('active');
                        h.querySelector('.sort-icon').innerHTML = '<i class="fas fa-sort"></i>';
                    });
                    
                    // Establecer nuevo orden
                    if (currentSort.column === column) {
                        currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
                    } else {
                        currentSort.column = column;
                        currentSort.direction = 'asc';
                    }
                    
                    // Actualizar UI
                    header.classList.add('active');
                    const icon = header.querySelector('.sort-icon');
                    icon.innerHTML = currentSort.direction === 'asc' 
                        ? '<i class="fas fa-sort-up"></i>' 
                        : '<i class="fas fa-sort-down"></i>';
                    icon.style.opacity = '1';
                    
                    renderInvestorsTable();
                });
            });

            // Exportar datos
            document.getElementById('export-button').addEventListener('click', () => {
                const dropdown = document.getElementById('export-dropdown');
                dropdown.classList.toggle('hidden');
            });

            // Cerrar dropdown de exportación al hacer clic fuera
            document.addEventListener('click', (e) => {
                if (!e.target.closest('#export-button') && !e.target.closest('#export-dropdown')) {
                    document.getElementById('export-dropdown').classList.add('hidden');
                }
            });

            // Opciones de exportación
            document.querySelectorAll('.export-option').forEach(option => {
                option.addEventListener('click', (e) => {
                    e.preventDefault();
                    const type = e.target.getAttribute('data-type');
                    exportData(type);
                    document.getElementById('export-dropdown').classList.add('hidden');
                });
            });

            // Exportar datos de inversor con menú desplegable mejorado
            document.getElementById('export-investor').addEventListener('click', (e) => {
                if (!currentInvestorId) return;
                
                // Crear menú desplegable
                const menu = document.createElement('div');
                menu.className = 'absolute right-0 mt-1 w-48 bg-altum-card-bg border border-altum-border rounded-md shadow-lg z-10';
                menu.innerHTML = `
                    <div class="py-1">
                        <a href="#" class="block px-4 py-2 text-sm text-altum-text-primary hover:bg-altum-dark-bg export-investor-option" data-type="csv" data-datatype="all">CSV (Todo)</a>
                        <a href="#" class="block px-4 py-2 text-sm text-altum-text-primary hover:bg-altum-dark-bg export-investor-option" data-type="pdf" data-datatype="all">PDF (Todo)</a>
                        <a href="#" class="block px-4 py-2 text-sm text-altum-text-primary hover:bg-altum-dark-bg export-investor-option" data-type="csv" data-datatype="operations">CSV (Operaciones)</a>
                        <a href="#" class="block px-4 py-2 text-sm text-altum-text-primary hover:bg-altum-dark-bg export-investor-option" data-type="csv" data-datatype="transactions">CSV (Transacciones)</a>
                    </div>
                `;
                
                document.body.appendChild(menu);
                
                // Posicionar el menú
                const button = document.getElementById('export-investor');
                const rect = button.getBoundingClientRect();
                menu.style.position = 'fixed';
                menu.style.top = `${rect.bottom}px`;
                menu.style.right = `${window.innerWidth - rect.right}px`;
                
                // Cerrar al hacer clic fuera
                const clickHandler = (e) => {
                    if (!menu.contains(e.target) && e.target !== button) {
                        document.body.removeChild(menu);
                        document.removeEventListener('click', clickHandler);
                    }
                };
                
                document.addEventListener('click', clickHandler);
                
                // Manejar opciones de exportación
                menu.querySelectorAll('.export-investor-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        e.preventDefault();
                        exportData(
                            e.target.getAttribute('data-type'), 
                            currentInvestorId,
                            e.target.getAttribute('data-datatype')
                        );
                        document.body.removeChild(menu);
                        document.removeEventListener('click', clickHandler);
                    });
                });
            });

            // Menú móvil
            document.getElementById('mobile-menu-button').addEventListener('click', () => {
                document.getElementById('mobile-menu').classList.add('open');
            });

            document.getElementById('close-mobile-menu').addEventListener('click', () => {
                document.getElementById('mobile-menu').classList.remove('open');
            });

            // Pestañas en detalle de inversor
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', () => {
                    // Desactivar todas las pestañas
                    document.querySelectorAll('.tab-button').forEach(btn => {
                        btn.classList.remove('active', 'text-altum-accent', 'border-altum-accent');
                        btn.classList.add('text-altum-text-secondary', 'border-transparent');
                    });
                    
                    // Activar pestaña actual
                    button.classList.add('active', 'text-altum-accent', 'border-altum-accent');
                    button.classList.remove('text-altum-text-secondary', 'border-transparent');
                    
                    // Ocultar todos los contenidos
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.add('hidden');
                    });
                    
                    // Mostrar contenido correspondiente
                    const tabId = button.getAttribute('data-tab');
                    document.getElementById(`${tabId}-tab`).classList.remove('hidden');
                });
            });

            // Filtros de tiempo en gráfico
            document.querySelectorAll('.time-range-btn').forEach(button => {
                button.addEventListener('click', function() {
                    // Actualizar estilos de los botones
                    document.querySelectorAll('.time-range-btn').forEach(btn => {
                        btn.classList.remove('bg-altum-accent', 'text-white');
                        btn.classList.add('bg-altum-card-bg', 'text-altum-text-secondary', 'border', 'border-altum-border');
                    });
                    
                    this.classList.add('bg-altum-accent', 'text-white');
                    this.classList.remove('bg-altum-card-bg', 'text-altum-text-secondary', 'border', 'border-altum-border');
                    
                    // Actualizar el gráfico
                    if (currentInvestorId) {
                        const investor = investorsData.find(i => i.id === currentInvestorId);
                        if (investor) {
                            updateChartForTimeRange(this.getAttribute('data-range'), investor);
                        }
                    }
                });
            });

            // Buscar operaciones
            document.getElementById('search-operations').addEventListener('input', (e) => {
                if (currentInvestorId) {
                    const investor = investorsData.find(i => i.id === currentInvestorId);
                    if (investor) {
                        renderOperationsTable(investor.operations, e.target.value);
                    }
                }
            });

            // Filtrar operaciones por fecha
            document.querySelectorAll('.date-filter').forEach(button => {
                button.addEventListener('click', function() {
                    // Actualizar estilos de los botones
                    document.querySelectorAll('.date-filter').forEach(btn => {
                        btn.classList.remove('bg-altum-accent', 'text-white');
                        btn.classList.add('bg-altum-card-bg', 'text-altum-text-secondary', 'border', 'border-altum-border');
                    });
                    
                    this.classList.add('bg-altum-accent', 'text-white');
                    this.classList.remove('bg-altum-card-bg', 'text-altum-text-secondary', 'border', 'border-altum-border');
                    
                    // Actualizar tabla de operaciones
                    if (currentInvestorId) {
                        const investor = investorsData.find(i => i.id === currentInvestorId);
                        if (investor) {
                            renderOperationsTable(investor.operations, '', this.getAttribute('data-range'));
                        }
                    }
                });
            });

            // Buscar transacciones
            document.getElementById('search-transactions').addEventListener('input', (e) => {
                if (currentInvestorId) {
                    const investor = investorsData.find(i => i.id === currentInvestorId);
                    if (investor) {
                        renderTransactionsTable(investor.transactions, e.target.value);
                    }
                }
            });

            // Filtrar transacciones por fecha
            document.querySelectorAll('.date-filter-tx').forEach(button => {
                button.addEventListener('click', function() {
                    // Actualizar estilos de los botones
                    document.querySelectorAll('.date-filter-tx').forEach(btn => {
                        btn.classList.remove('bg-altum-accent', 'text-white');
                        btn.classList.add('bg-altum-card-bg', 'text-altum-text-secondary', 'border', 'border-altum-border');
                    });
                    
                    this.classList.add('bg-altum-accent', 'text-white');
                    this.classList.remove('bg-altum-card-bg', 'text-altum-text-secondary', 'border', 'border-altum-border');
                    
                    // Actualizar tabla de transacciones
                    if (currentInvestorId) {
                        const investor = investorsData.find(i => i.id === currentInvestorId);
                        if (investor) {
                            renderTransactionsTable(investor.transactions, '', this.getAttribute('data-range'));
                        }
                    }
                });
            });

            // Ordenación de operaciones (implementación corregida)
            document.querySelectorAll('#detail-operations .sortable-header').forEach(header => {
                header.addEventListener('click', () => {
                    const column = header.getAttribute('data-column');
                    const investor = investorsData.find(i => i.id === currentInvestorId);
                    if (!investor) return;

                    // Ordenar operaciones
                    investor.operations.sort((a, b) => {
                        if (column === 'date') {
                            return currentSort.direction === 'asc' 
                                ? formatDate(a.date) - formatDate(b.date)
                                : formatDate(b.date) - formatDate(a.date);
                        } else if (column === 'result') {
                            return currentSort.direction === 'asc' 
                                ? a.profit - b.profit
                                : b.profit - a.profit;
                        } else {
                            return currentSort.direction === 'asc'
                                ? String(a[column]).localeCompare(String(b[column]))
                                : String(b[column]).localeCompare(String(a[column]));
                        }
                    });

                    renderOperationsTable(investor.operations);
                });
            });
        });
    </script>
</body>
</html>
